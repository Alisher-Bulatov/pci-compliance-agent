version: 1
applications:
  - appRoot: webui   # must match your AMPLIFY_MONOREPO_APP_ROOT
    frontend:
      phases:
        preBuild:
          commands:
            - npm ci
        build:
          commands:
            # Show the value in logs (helps verify)
            - echo "VITE_API_BASE_URL=$VITE_API_BASE_URL"
            # Make sure Vite gets it (create .env.production for this build only)
            - printf 'VITE_API_BASE_URL=%s\n' "$VITE_API_BASE_URL" > .env.production
            - npm run build
      artifacts:
        baseDirectory: dist
        files:
          - '**/*'
      cache:
        paths:
          - node_modules/**/*
